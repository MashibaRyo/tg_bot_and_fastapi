# tg_bot_and_fastapi

–ü—Ä–æ–µ–∫—Ç, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–π Telegram‚Äë–±–æ—Ç–∞ –∏ FastAPI, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å REST API –¥–ª—è **–ø–æ—Å—Ç–æ–≤** (—Å–æ–∑–¥–∞–Ω–∏–µ, —á—Ç–µ–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ) —Å Swagger UI  
- –ó–∞–ø—É—Å—Ç–∏—Ç—å Telegram‚Äë–±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π:  
  1. –ü–æ –∫–æ–º–∞–Ω–¥–µPI –¥–ª—è **–ø–≤—ã–≤–æ–¥–∏—Ç inline‚Äë–∫–Ω–æ–ø–∫–∏ —Å–æ –≤—Å–µ–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –ø–æ—Å—Ç–æ–≤  
  2. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É —à–ª—ë—Ç –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ (–∑–∞–≥–æ–ª–æ–≤–æ–∫, –¥–∞—Ç—É —Å–æ–∑–¥–∞–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ)

–í—Å—è —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —á–µ—Ä–µ–∑ SQLAlchemy¬†2.0+ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é SQLite).


## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

.
‚îú‚îÄ‚îÄ main.py             # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞: –ø–æ–¥–Ω–∏–º–∞–µ—Ç FastAPI –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞
‚îú‚îÄ‚îÄ database.py         # –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ SQLAlchemy –∏ —Ñ–∞–±—Ä–∏–∫–∞ —Å–µ—Å—Å–∏–π
‚îú‚îÄ‚îÄ crud.py             # —Ñ—É–Ω–∫—Ü–∏–∏ CRUD –¥–ª—è –º–æ–¥–µ–ª–∏ Post
‚îú‚îÄ‚îÄ posts/
‚îÇ   ‚îú‚îÄ‚îÄ models.py       # ORM‚Äë–º–æ–¥–µ–ª—å Post
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py      # Pydantic‚Äë—Å—Ö–µ–º—ã –¥–ª—è Post (—Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
‚îÇ   ‚îî‚îÄ‚îÄ router.py       # –º–∞—Ä—à—Ä—É—Ç—ã FastAPI –ø–æ–¥ –ø—Ä–µ—Ñ–∏–∫—Å–æ–º /posts
‚îú‚îÄ‚îÄ users/              # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ª–æ–≥–∏–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ migration/          # –ø–∞–ø–∫–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ Alembic
‚îÇ   ‚îî‚îÄ‚îÄ versions/
‚îÇ       ‚îî‚îÄ‚îÄ ‚Ä¶         # —Ñ–∞–π–ª—ã —Ä–µ–≤–∏–∑–∏–π
‚îú‚îÄ‚îÄ database3.db        # –ø—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ SQLite (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å)
‚îú‚îÄ‚îÄ requirements.txt    # —Å–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îî‚îÄ‚îÄ alembic.ini         # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic


## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

```bash
git clone https://github.com/MashibaRyo/tg_bot_and_fastapi.git
cd tg_bot_and_fastapi
python -m venv .venv
source .venv/bin/activate            # macOS/Linux
# .venv\Scripts\activate             # Windows
pip install -r requirements.txt

2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –∏–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

export BOT_TOKEN="–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞"
export DATABASE_URL="sqlite+aiosqlite:///./database3.db"

–î–ª—è PostgreSQL –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å
export DATABASE_URL="postgresql+asyncpg://user:pass@host:5432/dbname"

3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic

alembic upgrade head

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—É posts –≤ –±–∞–∑–µ.

4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

python main.py

 ‚Ä¢ FastAPI –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É http://127.0.0.1:8000
 ‚Ä¢ Swagger UI ‚Üí http://127.0.0.1:8000/docs
 ‚Ä¢ Telegram‚Äë–±–æ—Ç –Ω–∞—á–Ω—ë—Ç polling


üì¶ REST API (FastAPI)

–í—Å–µ —ç–Ω–¥–ø–æ–π–Ω—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø–æ–¥ –ø—Ä–µ—Ñ–∏–∫—Å–æ–º /posts.

–ú–µ—Ç–æ–¥ –ü—É—Ç—å –û–ø–∏—Å–∞–Ω–∏–µ
GET /posts/ –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤
GET /posts/{id} –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç –ø–æ ID
POST /posts/ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—Å—Ç
PATCH /posts/{id} –ß–∞—Å—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—è –ø–æ—Å—Ç–∞
DELETE /posts/{id} –£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç

–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏—Ö –º–æ–∂–Ω–æ –≤ Swagger UI: http://127.0.0.1:8000/docs.


ü§ñ Telegram‚Äë–±–æ—Ç

–ö–æ–º–∞–Ω–¥—ã
 ‚Ä¢ /posts
–ë–æ—Ç –ø—Ä–∏—Å—ã–ª–∞–µ—Ç inline‚Äë–∫–Ω–æ–ø–∫–∏ —Å–æ –≤—Å–µ–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –ø–æ—Å—Ç–æ–≤.
–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞.

–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
 1. –í main.py –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —Ö–µ–Ω–¥–ª–µ—Ä—ã aiogram:
 ‚Ä¢ /posts ‚Äî –∑–∞–ø—Ä–æ—Å –≤ –ë–î, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
 ‚Ä¢ callback_query ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –µ–≥–æ —Ç–µ–∫—Å—Ç–æ–º
 2. –î–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Telegram –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è aiogram.


‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –û–ø–∏—Å–∞–Ω–∏–µ
BOT_TOKEN –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Telegram‚Äë–±–æ—Ç–∞
DATABASE_URL URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è SQLAlchemy (SQLite –∏ —Ç.–¥.)

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –∏–ª–∏ –≤ —Ñ–∞–π–ª–µ .env (—Å –ø–æ–º–æ—â—å—é python-dotenv).


üõ†Ô∏è –ú–∏–≥—Ä–∞—Ü–∏–∏ Alembic
 ‚Ä¢ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –º–æ–¥–µ–ª—è—Ö:

alembic revision --autogenerate -m "–æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"


 ‚Ä¢ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏:

alembic upgrade head


 ‚Ä¢ –°–±—Ä–æ—Å–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):

rm migration/versions/*.py
alembic stamp head
alembic revision --autogenerate -m "baseline"
alembic upgrade head



‚ú® Contributing
 1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
 2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è —Ñ–∏—á–∏: git checkout -b feat/XYZ
 3. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –∑–∞–∫–æ–º–º–∏—Ç—å—Ç–µ: git commit -m "Add XYZ"
 4. –ó–∞–ø—É—à—å—Ç–µ –≤ —Å–≤–æ–π —Ñ–æ—Ä–∫: git push origin feat/XYZ
 5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request
